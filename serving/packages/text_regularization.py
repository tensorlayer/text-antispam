#! /usr/bin/env python3

import re
# import opencc


def strtr(text, replace):
    for s, r in replace.items():
        text = text.replace(s, r)
    return text


# def simplify(text):
#     return opencc.convert(text)


# def traditionalize(text):
#     """ https://pypi.python.org/pypi/OpenCC
#     """
#     return opencc.convert(text, config='s2t.json')


def sbcCase(text):
    """è½¬æ¢å…¨è§’å­—ç¬¦ä¸ºåŠè§’å­—ç¬¦
    SBC case to DBC case
    """
    return strtr(text, {
        "ï¼" : "0", "ï¼‘" : "1", "ï¼’" : "2", "ï¼“" : "3", "ï¼”" : "4",
        "ï¼•" : "5", "ï¼–" : "6", "ï¼—" : "7", "ï¼˜" : "8", "ï¼™" : "9",
        'ï¼¡' : 'A', 'ï¼¢' : 'B', 'ï¼£' : 'C', 'ï¼¤' : 'D', 'ï¼¥' : 'E',
        'ï¼¦' : 'F', 'ï¼§' : 'G', 'ï¼¨' : 'H', 'ï¼©' : 'I', 'ï¼ª' : 'J',
        'ï¼«' : 'K', 'ï¼¬' : 'L', 'ï¼­' : 'M', 'ï¼®' : 'N', 'ï¼¯' : 'O',
        'ï¼°' : 'P', 'ï¼±' : 'Q', 'ï¼²' : 'R', 'ï¼³' : 'S', 'ï¼´' : 'T',
        'ï¼µ' : 'U', 'ï¼¶' : 'V', 'ï¼·' : 'W', 'ï¼¸' : 'X', 'ï¼¹' : 'Y',
        'ï¼º' : 'Z', 'ï½' : 'a', 'ï½‚' : 'b', 'ï½ƒ' : 'c', 'ï½„' : 'd',
        'ï½…' : 'e', 'ï½†' : 'f', 'ï½‡' : 'g', 'ï½ˆ' : 'h', 'ï½‰' : 'i',
        'ï½Š' : 'j', 'ï½‹' : 'k', 'ï½Œ' : 'l', 'ï½' : 'm', 'ï½' : 'n',
        'ï½' : 'o', 'ï½' : 'p', 'ï½‘' : 'q', 'ï½’' : 'r', 'ï½“' : 's',
        'ï½”' : 't', 'ï½•' : 'u', 'ï½–' : 'v', 'ï½—' : 'w', 'ï½˜' : 'x',
        'ï½™' : 'y', 'ï½š' : 'z',
    })


def circleCase(text):
    """è½¬æ¢â‘ æ•°å­—ä¸ºåŠè§’æ•°å­—
    â‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨â‘© case å…¨è§’
    â¹â¸â½â¼â½â¼â¾â½â¼
    â€ââ‚âƒâ„â…â†â‡âˆ
    """
    return strtr(text, {
        "â€" : "1", "â" : "2", "â‚" : "3", "âƒ" : "4", "â„" : "5",
        "â…" : "6", "â†" : "7", "â‡" : "8", "âˆ" : "9", "â‘ " : "1",
        "â‘¡" : "2", "â‘¢" : "3", "â‘£" : "4", "â‘¤" : "5", "â‘¥" : "6",
        "â‘¦" : "7", "â‘§" : "8", "â‘¨" : "9", "â¶" : "1", "â·" : "2",
        "â¸" : "3", "â¹" : "4", "âº" : "5", "â»" : "6", "â¼" : "7",
        "â½" : "8", "â¾" : "9", "âŠ" : "1", "â‹" : "2", "âŒ" : "3",
        "â" : "4", "â" : "5", "â" : "6", "â" : "7", "â‘" : "8",
        "â’" : "9", 'â’¶' : 'A', 'â’·' : 'B', 'â’¸' : 'C', 'â’¹' : 'D',
        'â’º' : 'E', 'â’»' : 'F', 'â’¼' : 'G', 'â’½' : 'H', 'â’¾' : 'I',
        'â’¿' : 'J', 'â“€' : 'K', 'â“' : 'L', 'â“‚' : 'M', 'â“ƒ' : 'N',
        'â“„' : 'O', 'â“…' : 'P', 'â“†' : 'Q', 'â“‡' : 'R', 'â“ˆ' : 'S',
        'â“‰' : 'T', 'â“Š' : 'U', 'â“‹' : 'V', 'â“Œ' : 'W', 'â“' : 'X',
        'â“' : 'Y', 'â“' : 'Z', 'â“' : 'a', 'â“‘' : 'b', 'â“’' : 'c',
        'â““' : 'd', 'â“”' : 'e', 'â“•' : 'f', 'â“–' : 'g', 'â“—' : 'h',
        'â“˜' : 'i', 'â“™' : 'j', 'â“š' : 'k', 'â“›' : 'l', 'â“œ' : 'm',
        'â“' : 'n', 'â“' : 'o', 'â“Ÿ' : 'p', 'â“ ' : 'q', 'â“¡' : 'r',
        'â“¢' : 's', 'â“£' : 't', 'â“¤' : 'u', 'â“¥' : 'v', 'â“¦' : 'w',
        'â“§' : 'x', 'â“¨' : 'y', 'â“©' : 'z',
        "ãŠ€" : "ä¸€", "ãŠ" : "äºŒ", "ãŠ‚" : "ä¸‰", "ãŠƒ" : "å››",
        "ãŠ„" : "äº”", "ãŠ…" : "å…­", "ãŠ†" : "ä¸ƒ", "ãŠ‡" : "å…«",
        "ãŠˆ" : "ä¹",
    })


def bracketCase(text):
    """è½¬æ¢â‘´æ•°å­—ä¸ºåŠè§’æ•°å­—
    â‘´ â‘µ â‘¶ â‘· â‘¸ â‘¹ â‘º â‘» â‘¼case å…¨è§’
    """
    return strtr(text, {
        "â‘´" : "1", "â‘µ" : "2", "â‘¶" : "3", "â‘·" : "4", "â‘¸" : "5",
        "â‘¹" : "6", "â‘º" : "7", "â‘»" : "8", "â‘¼" : "9",
        'ğŸ„' : 'A', 'ğŸ„‘' : 'B', 'ğŸ„’' : 'C', 'ğŸ„“' : 'D', 'ğŸ„”' : 'E',
        'ğŸ„•' : 'F', 'ğŸ„–' : 'G', 'ğŸ„—' : 'H', 'ğŸ„˜' : 'I', 'ğŸ„™' : 'J',
        'ğŸ„š' : 'K', 'ğŸ„›' : 'L', 'ğŸ„œ' : 'M', 'ğŸ„' : 'N', 'ğŸ„' : 'O',
        'ğŸ„Ÿ' : 'P', 'ğŸ„ ' : 'Q', 'ğŸ„¡' : 'R', 'ğŸ„¢' : 'S', 'ğŸ„£' : 'T',
        'ğŸ„¤' : 'U', 'ğŸ„¥' : 'V', 'ğŸ„¦' : 'W', 'ğŸ„§' : 'X', 'ğŸ„¨' : 'Y',
        'ğŸ„©' : 'Z', 'â’œ' : 'a', 'â’' : 'b', 'â’' : 'c', 'â’Ÿ' : 'd',
        'â’ ' : 'e', 'â’¡' : 'f', 'â’¢' : 'g', 'â’£' : 'h', 'â’¤' : 'i',
        'â’¥' : 'j', 'â’¦' : 'k', 'â’§' : 'l', 'â’¨' : 'm', 'â’©' : 'n',
        'â’ª' : 'o', 'â’«' : 'p', 'â’¬' : 'q', 'â’­' : 'r', 'â’®' : 's',
        'â’¯' : 't', 'â’°' : 'u', 'â’±' : 'v', 'â’²' : 'w', 'â’³' : 'x',
        'â’´' : 'y', 'â’µ' : 'z',
        "ãˆ " : "ä¸€", "ãˆ¡" : "äºŒ", "ãˆ¢" : "ä¸‰", "ãˆ£" : "å››",
        "ãˆ¤" : "äº”", "ãˆ¥" : "å…­", "ãˆ¦" : "ä¸ƒ", "ãˆ§" : "å…«",
        "ãˆ¨" : "ä¹",
    })


def dotCase(text):
    """è½¬æ¢â‘´æ•°å­—ä¸ºåŠè§’æ•°å­—
    â’ˆâ’‰â’Šâ’‹â’Œâ’â’â’â’case å…¨è§’
    """
    return strtr(text, {
        "â’ˆ" : "1",
        "â’‰" : "2",
        "â’Š" : "3",
        "â’‹" : "4",
        "â’Œ" : "5",
        "â’" : "6",
        "â’" : "7",
        "â’" : "8",
        "â’" : "9",
    })


def specialCase(text):
    """ç‰¹æ®Šå­—ç¬¦æ¯”å¦‚å¸Œè…Šå­—ç¬¦ï¼Œè¥¿é‡Œå°”å­—æ¯
    """
    return strtr(text, {
        # å¸Œè…Šå­—æ¯
        "Î‘" : "A", "Î’" : "B", "Î•" : "E", "Î–" : "Z", "Î—" : "H",
        "Î™" : "I", "Îš" : "K", "Îœ" : "M", "Î" : "N", "ÎŸ" : "O",
        "Î¡" : "P", "Î¤" : "T", "Î§" : "X", "Î±" : "a", "Î²" : "b",
        "Î³" : "y", "Î¹" : "l", "Îº" : "k", "Î¼" : "u", "Î½" : "v",
        "Î¿" : "o", "Ï" : "p", "Ï„" : "t", "Ï‡" : "x",

        # è¥¿é‡Œå°”å­—æ¯ (U+0400 - U+04FF)
        "Ğ€" : "E", "Ğ" : "E", "Ğ…" : "S", "Ğ†" : "I", "Ğ‡" : "I",
        "Ğˆ" : "J", "ĞŒ" : "K", "Ğ" : "A", "Ğ’" : "B", "Ğ•" : "E",
        "Ğ—" : "3", "Î–" : "Z", "Ğ˜" : "N", "Ğœ" : "M", "Ğ" : "H",
        "Ğ" : "O", "Ğ " : "P", "Ğ¡" : "C", "Ğ¢" : "T", "Ğ£" : "y",
        "Ğ¥" : "X", "Ğ¬" : "b", "Ğª" : "b", "Ğ°" : "a", "Ğ²" : "B",
        "Ğµ" : "e", "Ğº" : "K", "Ğ¼" : "M", "Ğ½" : "H", "Ğ¾" : "O",
        "Ğ¿" : "n", "Ñ€" : "P", "Ñ" : "c", "Ñ‚" : "T", "Ñƒ" : "y",
        "Ñ…" : "x", "Ñˆ" : "w", "ÑŒ" : "b", "Ñ•" : "s", "Ñ–" : "i",
        "Ñ˜" : "j",

        "Ã€" : "A", "Ã" : "A", "Ã‚" : "A", "Ãƒ" : "A", "Ã„" : "A", "Ã…" : "A", "Ä€" : "A", "Ä‚" : "A", "Ä‚" : "A",
        "Ã‡" : "C", "Ä†" : "C", "Äˆ" : "C", "ÄŠ" : "C",
        "Ã" : "D", "Ä" : "D", "Ä" : "D",
        "Ãˆ" : "E", "Ã‰" : "E", "ÃŠ" : "E", "Ã‹" : "E", "Ä’" : "E", "Ä–" : "E", "Ä˜" : "E", "Äš" : "E",
        "Äœ" : "G", "Ä " : "G", "Ä¢" : "G",
        "Ä¤" : "H", "Ä¦" : "H",
        "ÃŒ" : "I", "Ã" : "I", "Ã®" : "I", "Ã¯" : "I", "Ä¯" : "I",
        "Ä´" : "J",
        "Ä¶" : "K",
        "Ä»" : "L", "Å" : "L",
        "Ã‘" : "N", "Åƒ" : "N", "Å…" : "N", "Å‡" : "N",
        "Ã’" : "O", "Ã“" : "O", "Ã”" : "O", "Ã•" : "O", "Ã–" : "O", "Å" : "O",
        "Å”" : "R", "Å˜" : "R",
        "Åš" : "S", "Åœ" : "S", "Å" : "S", "Å " : "S", "È˜" : "S",
        "Å¢" : "T", "Å¤" : "T", "Èš" : "T",
        "Ã™" : "U", "Ãš" : "U", "Ã›" : "U", "Ãœ" : "U", "Åª" : "U", "Å¬" : "U", "Å®" : "U", "Å°" : "U", "Å²" : "U",
        "Å´" : "W",
        "Ã" : "Y", "Å¶" : "Y", "Å¸" : "Y",
        "Å¹" : "Z", "Å»" : "Z", "Å½" : "Z",

        "Ã " : "a", "Ã¡" : "a", "Ã¢" : "a", "Ã£" : "a", "Ã¤" : "a", "Ã¥" : "a", "Ä" : "a", "Äƒ" : "a", "Ä…" : "a",
        "Ã§" : "c", "Ä‡" : "c", "Ä‰" : "c", "Ä‹" : "c",
        "Ä" : "d", "Ä‘" : "d",
        "Ã¨" : "e", "Ã©" : "e", "Ãª" : "e", "Ã«" : "e", "Ä“" : "e", "Ä—" : "e", "Ä™" : "e", "Ä›" : "e", "É™" : "e",
        "Ä" : "g", "Ä¡" : "g", "Ä£" : "g",
        "Ä¥" : "h", "Ä§" : "h",
        "Ã¬" : "i", "Ã­" : "i", "Ã®" : "i", "Ã¯" : "i", "Ä«" : "i", "Ä¯" : "i",
        "Äµ" : "j",
        "Ä·" : "k",
        "Ä¼" : "l",
        "Ã±" : "n", "Å„" : "n", "Å†" : "n", "Åˆ" : "n",
        "Ã²" : "o", "Ã³" : "o", "Ã´" : "o", "Ãµ" : "o", "Ã¶" : "o", "Å‘" : "o", "Å•" : "r", "Å™" : "r",
        "Å›" : "s", "Å" : "s", "ÅŸ" : "s", "Å¡" : "s", "È™" : "s",
        "Å£" : "t", "Å¥" : "t", "È›" : "t",
        "Ã¹" : "u", "Ãº" : "u", "Ã»" : "u", "Ã¼" : "u", "Å«" : "u", "Å­" : "u", "Å¯" : "u", "Å±" : "u", "Å³" : "u",
        "Åµ" : "w",
        "Ã½" : "y", "Å·" : "y", "Ã¿" : "y",
        "Åº" : "z", "Å¼" : "z", "Å¾" : "z",

        # ç½—é©¬æ•°å­—Roman numerals
        "â… " : "I", "â…¡" : "II", "â…¢" : "III", "â…£" : "IV", "â…¤" : "V", "â…¥" : "VI", "â…¦" : "VII",
        "â…§" : "VIII", "â…¨" : "IX", "â…©" : "X", "â…ª" : "XI", "â…«" : "XII", "â…¬" : "L", "â…­" : "C",
        "â…®" : "D", "â…¯" : "M",
        "â…°" : "i", "â…±" : "ii", "â…²" : "iii", "â…³" : "iv", "â…´" : "v", "â…µ" : "vi", "â…¶" : "vii",
        "â…·" : "viii", "â…¸" : "ix", "â…¹" : "x", "â…º" : "xi", "â…»" : "xii", "â…¼" : "l", "â…½" : "c",
        "â…¾" : "d", "â…¿" : "m",
    })


def extractWords(text):
    """æŠ½å‡ºä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ï¼Œå¿½ç•¥æ ‡ç‚¹ç¬¦å·å’Œç‰¹æ®Šå­—ç¬¦ï¼ˆè¡¨æƒ…ï¼‰
    ä¸€èˆ¬ç”¨ä¸ååƒåœ¾
    """
    text = text.lower() # è¯å‘é‡åªè®¡ç®—å°å†™
    # text = simplify(text) # ç¹ä½“è½¬ç®€ä½“
    text = sbcCase(text) # å…¨è§’è½¬åŠè§’
    text = circleCase(text) # ç‰¹æ®Šå­—ç¬¦
    text = bracketCase(text) # ç‰¹æ®Šå­—ç¬¦
    text = dotCase(text) # ç‰¹æ®Šå­—ç¬¦
    text = specialCase(text) # ç‰¹æ®Šå­—ç¬¦
    pattern = re.compile(r"[0-9A-Za-z\u4E00-\u9FFF]+")
    match = pattern.findall(text)
    if match:
        text = " ".join(match)
    else:
        text = " "

    return text
